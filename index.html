<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uzayda Gezegen Toplama Oyunu</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a2a, #000033, #0a0a2a);
            color: #e6e6e6;
            min-height: 100vh;
            overflow: hidden;
        }
        
        .game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: auto 1fr auto;
            grid-gap: 10px;
            padding: 10px;
        }
        
        header {
            grid-row: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 12px 20px;
            border: 1px solid #4fc3dc;
            box-shadow: 0 0 15px rgba(79, 195, 220, 0.3);
            z-index: 10;
        }
        
        .stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .stat-box {
            background: rgba(0, 30, 60, 0.8);
            padding: 8px 15px;
            border-radius: 10px;
            border: 1px solid #00a8ff;
            min-width: 100px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #a0d2ff;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #00a8ff;
            margin-top: 3px;
        }
        
        #click-area {
            grid-row: 2;
            background: rgba(0, 5, 15, 0.7);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid #9d4edd;
            box-shadow: 0 0 15px rgba(157, 78, 221, 0.3);
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .controls {
            grid-row: 3;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 10;
        }
        
        .shop {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid #f9c74f;
            box-shadow: 0 0 15px rgba(249, 199, 79, 0.3);
            display: flex;
            flex-direction: column;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .shop-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f9c74f;
        }
        
        .shop-title {
            font-size: 20px;
            color: #f9c74f;
        }
        
        .upgrade {
            background: rgba(0, 30, 60, 0.8);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 12px;
            border: 1px solid #4361ee;
            transition: transform 0.3s;
        }
        
        .upgrade:hover {
            transform: translateY(-3px);
            border-color: #00a8ff;
        }
        
        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .upgrade-name {
            font-size: 16px;
            font-weight: bold;
            color: #4cc9f0;
        }
        
        .upgrade-price {
            font-weight: bold;
            color: #f9c74f;
            font-size: 16px;
        }
        
        .upgrade-desc {
            margin-bottom: 12px;
            color: #b0b0b0;
            font-size: 13px;
        }
        
        .btn {
            background: linear-gradient(45deg, #4361ee, #3a0ca3);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            width: 100%;
            font-size: 14px;
        }
        
        .btn:hover {
            background: linear-gradient(45deg, #4895ef, #4361ee);
            transform: scale(1.03);
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-shop {
            background: linear-gradient(45deg, #f9c74f, #f8961e);
            color: #2d00f7;
            font-weight: bold;
            font-size: 16px;
            padding: 12px;
            border-radius: 12px;
        }
        
        #message-popup {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 12px 25px;
            border-radius: 50px;
            border: 2px solid #00ff00;
            z-index: 100;
            transition: all 0.5s;
            opacity: 0;
            pointer-events: none;
            text-align: center;
            max-width: 90%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        #message-popup.show {
            opacity: 1;
            top: 30px;
        }
        
        #welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, #0a0a2a, #000033, #0a0a2a);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            text-align: center;
            padding: 20px;
        }
        
        .welcome-content {
            max-width: 90%;
            background: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 20px;
            border: 3px solid #00a8ff;
            box-shadow: 0 0 30px rgba(0, 168, 255, 0.5);
        }
        
        .game-title {
            font-size: 32px;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #4cc9f0, #4361ee, #9d4edd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(77, 201, 240, 0.5);
        }
        
        .instructions {
            font-size: 18px;
            line-height: 1.5;
            margin-bottom: 25px;
            color: #e0e0e0;
        }
        
        .start-btn {
            background: linear-gradient(45deg, #f72585, #b5179e);
            color: white;
            border: none;
            padding: 12px 40px;
            font-size: 20px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 15px;
            border: 2px solid #ff7096;
            box-shadow: 0 0 20px rgba(247, 37, 133, 0.5);
        }
        
        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(247, 37, 133, 0.7);
        }
        
        .key-hint {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid #4cc9f0;
            border-radius: 5px;
            padding: 2px 8px;
            margin: 0 3px;
            font-family: monospace;
        }
        
        .credit {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 12px;
            color: #9d4edd;
            border: 1px solid #9d4edd;
            z-index: 10;
        }
        
        .mobile-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .mobile-btn {
            flex: 1;
            background: linear-gradient(45deg, #4361ee, #3a0ca3);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 12px;
            font-weight: bold;
            text-align: center;
        }
        
        .save-indicator {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 12px;
            color: #4cc9f0;
            border: 1px solid #4cc9f0;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .save-indicator.show {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }
            
            .stats {
                width: 100%;
                justify-content: center;
            }
            
            .stat-box {
                min-width: 80px;
                padding: 6px 10px;
            }
            
            .stat-label {
                font-size: 12px;
            }
            
            .stat-value {
                font-size: 16px;
            }
            
            .game-title {
                font-size: 28px;
            }
            
            .instructions {
                font-size: 16px;
            }
            
            .start-btn {
                padding: 10px 30px;
                font-size: 18px;
            }
        }
        
        @media (max-height: 600px) {
            .shop {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <header>
            <h1>🌟 Uzayda Gezegen Toplama</h1>
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-label">Puan</div>
                    <div id="score" class="stat-value">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Tıklama Gücü</div>
                    <div id="click-power" class="stat-value">1</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Otomatik Toplayıcı</div>
                    <div id="auto-click" class="stat-value">0</div>
                </div>
            </div>
        </header>
        
        <div id="click-area"></div>
        
        <div class="controls">
            <button id="open-shop" class="btn btn-shop">Mağazayı Aç (M)</button>
            
            <div id="shop" class="shop hidden">
                <div class="shop-header">
                    <div class="shop-title">🚀 Uzay Mağazası</div>
                    <button id="close-shop" class="btn">Kapat</button>
                </div>
                
                <div class="upgrade">
                    <div class="upgrade-header">
                        <div class="upgrade-name">Tıklama Gücü</div>
                        <div class="upgrade-price">10 Puan</div>
                    </div>
                    <div class="upgrade-desc">Her tıklamada topladığın puanı arttırır</div>
                    <button class="btn" onclick="buyUpgrade('click', 10)">Satın Al</button>
                </div>
                
                <div class="upgrade">
                    <div class="upgrade-header">
                        <div class="upgrade-name">Otomatik Toplayıcı</div>
                        <div class="upgrade-price">25 Puan</div>
                    </div>
                    <div class="upgrade-desc">Saniyede 1 puan otomatik olarak toplar</div>
                    <button class="btn" onclick="buyUpgrade('auto', 25)">Satın Al</button>
                </div>
                
                <div class="upgrade">
                    <div class="upgrade-header">
                        <div class="upgrade-name">Yeni Gezegen</div>
                        <div class="upgrade-price">50 Puan</div>
                    </div>
                    <div class="upgrade-desc">Daha değerli yeni bir gezegen aç</div>
                    <button class="btn" onclick="buyUpgrade('planet', 50)">Satın Al</button>
                </div>
            </div>
            
            <div class="mobile-controls">
                <div class="mobile-btn" id="mobile-click">Tıkla</div>
                <div class="mobile-btn" id="mobile-shop">Mağaza</div>
            </div>
        </div>
    </div>
    
    <div id="message-popup">
        <div id="message-text"></div>
    </div>
    
    <div id="welcome-screen">
        <div class="welcome-content">
            <h1 class="game-title">🌌 Uzayda Gezegen Toplama Oyunu</h1>
            <div class="instructions">
                <p>Gezegenlere tıklayarak puan topla ve mağazadan yükseltmeler satın al!</p>
                <p>🔹 Her gezegenin farklı bir değeri var</p>
                <p>🔹 Tıklama gücünü arttırarak daha fazla puan topla</p>
                <p>🔹 Otomatik toplayıcılar ile pasif gelir elde et</p>
                <p>🔹 Yeni gezegenler açarak oyunu ilerlet</p>
                <p>🔹 Mağazayı açmak için <span class="key-hint">M</span> tuşuna bas</p>
                <p style="color:#4cc9f0; margin-top:15px;">✅ Oyun durumunuz otomatik kaydediliyor</p>
            </div>
            <button class="start-btn">OYUNA BAŞLA</button>
        </div>
    </div>
    
    <div class="credit">Oyunu yapan: MTÇ kodlayan gardaşım</div>
    <div class="save-indicator" id="save-indicator">Oyun kaydedildi!</div>
    
    <audio id="click-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="buy-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // Oyun değişkenleri
        let score = 0;
        let clickPower = 1;
        let autoClicker = 0;
        let unlockedPlanets = 1;
        let gameStarted = false;
        const planets = [];
        const planetData = [
            { name: "MERKÜR", size: 0.4, color: 0x8B8B8B, price: 10 },
            { name: "VENÜS", size: 0.6, color: 0xE6C229, price: 25 },
            { name: "DÜNYA", size: 0.6, color: 0x1E90FF, price: 50 },
            { name: "MARS", size: 0.5, color: 0xC1440E, price: 100 },
            { name: "JÜPİTER", size: 1.0, color: 0xD39C61, price: 200 },
            { name: "SATÜRN", size: 0.9, color: 0xE4D191, price: 400, hasRings: true },
            { name: "URANÜS", size: 0.7, color: 0xC1E3E3, price: 800 },
            { name: "NEPTÜN", size: 0.7, color: 0x5B5DDF, price: 1600 },
            { name: "PLÜTON", size: 0.3, color: 0xE6E6FA, price: 3200 }
        ];

        // DOM elementleri
        const scoreElement = document.getElementById('score');
        const clickPowerElement = document.getElementById('click-power');
        const autoClickElement = document.getElementById('auto-click');
        const shopElement = document.getElementById('shop');
        const openShopBtn = document.getElementById('open-shop');
        const closeShopBtn = document.getElementById('close-shop');
        const messagePopup = document.getElementById('message-popup');
        const messageText = document.getElementById('message-text');
        const clickSound = document.getElementById('click-sound');
        const buySound = document.getElementById('buy-sound');
        const welcomeScreen = document.getElementById('welcome-screen');
        const mobileClickBtn = document.getElementById('mobile-click');
        const mobileShopBtn = document.getElementById('mobile-shop');
        const saveIndicator = document.getElementById('save-indicator');

        // Three.js sahnesi
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000033);

        // Kamera ayarları
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 15;

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        document.getElementById('click-area').appendChild(renderer.domElement);

        // Işıklandırma
        const ambientLight = new THREE.AmbientLight(0x404040);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 10, 7);
        directionalLight.castShadow = true;
        scene.add(directionalLight);

        // Yıldızlar
        function createStars() {
            const starsGeometry = new THREE.BufferGeometry();
            const starsMaterial = new THREE.PointsMaterial({
                color: 0xFFFFFF,
                size: 0.15,
                transparent: true
            });

            const starsVertices = [];
            for (let i = 0; i < 5000; i++) {
                const x = THREE.MathUtils.randFloatSpread(2000);
                const y = THREE.MathUtils.randFloatSpread(2000);
                const z = THREE.MathUtils.randFloatSpread(2000);
                starsVertices.push(x, y, z);
            }

            starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
            const starField = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(starField);
        }

        // Gezegen oluşturma fonksiyonu
        function createPlanet(planetInfo) {
            const geometry = new THREE.SphereGeometry(planetInfo.size, 32, 32);
            const material = new THREE.MeshPhongMaterial({ 
                color: planetInfo.color,
                shininess: 100,
                emissive: planetInfo.color,
                emissiveIntensity: 0.2
            });
            
            const planet = new THREE.Mesh(geometry, material);
            planet.castShadow = true;
            planet.position.set(0, 0, 0);
            planet.userData = { 
                name: planetInfo.name,
                value: Math.max(1, Math.floor(planetInfo.price / 10)),
                originalSize: planetInfo.size,
                currentSize: planetInfo.size
            };
            
            if (planetInfo.hasRings) {
                const ringGeometry = new THREE.RingGeometry(planetInfo.size * 1.5, planetInfo.size * 2, 32);
                const ringMaterial = new THREE.MeshPhongMaterial({
                    color: 0xE4D191,
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.7
                });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.rotation.x = Math.PI / 3;
                planet.add(ring);
            }
            
            scene.add(planet);
            planets.push(planet);
            return planet;
        }

        // Başlangıç gezegenlerini oluştur
        function initPlanets() {
            for (let i = 0; i < unlockedPlanets; i++) {
                if (i < planetData.length) {
                    createPlanet(planetData[i]);
                }
            }
        }

        // Oyun durumunu kaydet
        function saveGameState() {
            const gameState = {
                score,
                clickPower,
                autoClicker,
                unlockedPlanets
            };
            
            localStorage.setItem('planetClickerGame', JSON.stringify(gameState));
            
            // Kayıt onayını göster
            saveIndicator.classList.add('show');
            setTimeout(() => {
                saveIndicator.classList.remove('show');
            }, 2000);
        }

        // Oyun durumunu yükle
        function loadGameState() {
            const savedState = localStorage.getItem('planetClickerGame');
            if (savedState) {
                const state = JSON.parse(savedState);
                score = state.score || 0;
                clickPower = state.clickPower || 1;
                autoClicker = state.autoClicker || 0;
                unlockedPlanets = state.unlockedPlanets || 1;
                
                // UI'ı güncelle
                updateScore();
                
                // Gezegenleri yeniden oluştur
                while (planets.length) {
                    scene.remove(planets.pop());
                }
                
                for (let i = 0; i < unlockedPlanets; i++) {
                    if (i < planetData.length) {
                        createPlanet(planetData[i]);
                    }
                }
                
                return true;
            }
            return false;
        }

        // Puan güncelleme
        function updateScore() {
            scoreElement.textContent = score;
            clickPowerElement.textContent = clickPower;
            autoClickElement.textContent = autoClicker;
        }

        // Tıklama efekti
        function animateClick(planet) {
            // Tıklama animasyonu
            gsap.to(planet.scale, {
                x: planet.userData.currentSize * 1.2,
                y: planet.userData.currentSize * 1.2,
                z: planet.userData.currentSize * 1.2,
                duration: 0.1,
                yoyo: true,
                repeat: 1
            });
            
            // Puan arttıkça büyüme
            planet.userData.currentSize = planet.userData.originalSize * (1 + (score / 5000));
            gsap.to(planet.scale, {
                x: planet.userData.currentSize,
                y: planet.userData.currentSize,
                z: planet.userData.currentSize,
                duration: 0.5
            });
        }

        // Satın alma efekti (küçülme)
        function animatePurchase(planet) {
            gsap.to(planet.scale, {
                x: planet.userData.originalSize * 0.5,
                y: planet.userData.originalSize * 0.5,
                z: planet.userData.originalSize * 0.5,
                duration: 0.3,
                yoyo: true,
                repeat: 1
            });
        }

        // Mesaj gösterimi
        function showMessage(text, color) {
            messageText.textContent = text;
            messageText.style.color = color;
            messagePopup.style.borderColor = color;
            messagePopup.classList.add('show');
            
            setTimeout(() => {
                messagePopup.classList.remove('show');
            }, 2000);
        }

        // Mağaza işlevleri
        function buyUpgrade(type, cost) {
            if (score < cost) {
                showMessage('Yeterli puan yok!', '#FF0000');
                return;
            }
            
            score -= cost;
            buySound.currentTime = 0;
            buySound.volume = 0.3;
            buySound.play();
            
            switch(type) {
                case 'click':
                    clickPower++;
                    showMessage('Tıklama gücü arttı!', '#00FF00');
                    if (planets.length > 0) animatePurchase(planets[0]);
                    break;
                case 'auto':
                    autoClicker++;
                    showMessage('Otomatik toplayıcı eklendi!', '#00FF00');
                    if (planets.length > 0) animatePurchase(planets[0]);
                    break;
                case 'planet':
                    if (unlockedPlanets < planetData.length) {
                        unlockedPlanets++;
                        // Önceki gezegeni kaldır
                        if (planets.length > 0) {
                            scene.remove(planets[0]);
                            planets.pop();
                        }
                        // Yeni gezegeni ekle
                        createPlanet(planetData[unlockedPlanets - 1]);
                        showMessage(`Yeni gezegen: ${planetData[unlockedPlanets - 1].name}`, '#00FF00');
                        if (planets.length > 0) animatePurchase(planets[0]);
                    } else {
                        showMessage('Tüm gezegenler açıldı!', '#FFFF00');
                    }
                    break;
            }
            
            updateScore();
            saveGameState(); // Oyun durumunu kaydet
        }

        // Klavye kontrolü
        function initKeyboardControls() {
            document.addEventListener('keydown', (e) => {
                if (e.key.toLowerCase() === 'm') {
                    toggleShop();
                }
            });
        }

        // Otomatik tıklayıcı
        function startAutoClickers() {
            setInterval(() => {
                if (gameStarted && autoClicker > 0) {
                    score += autoClicker;
                    updateScore();
                    saveGameState(); // Oyun durumunu kaydet
                }
            }, 1000);
        }

        // Tıklama olayları
        function initClickEvents() {
            const handleInteraction = (clientX, clientY) => {
                if (!gameStarted) return;
                
                // Renderer alanını al
                const rect = renderer.domElement.getBoundingClientRect();
                
                // Fare pozisyonunu normalize et
                const mouse = new THREE.Vector2();
                mouse.x = ((clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((clientY - rect.top) / rect.height) * 2 + 1;
                
                const raycaster = new THREE.Raycaster();
                raycaster.setFromCamera(mouse, camera);
                
                const intersects = raycaster.intersectObjects(planets);
                
                if (intersects.length > 0) {
                    const planet = intersects[0].object;
                    score += clickPower * planet.userData.value;
                    clickSound.currentTime = 0;
                    clickSound.volume = 0.2;
                    clickSound.play();
                    animateClick(planet);
                    updateScore();
                    saveGameState(); // Oyun durumunu kaydet
                }
            };

            renderer.domElement.addEventListener('click', (e) => handleInteraction(e.clientX, e.clientY));
            renderer.domElement.addEventListener('touchend', (e) => {
                e.preventDefault();
                handleInteraction(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
            });
            
            // Mobil tıklama butonu
            mobileClickBtn.addEventListener('click', () => {
                if (!gameStarted) return;
                
                // Merkeze tıklama simüle et
                const rect = renderer.domElement.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                handleInteraction(centerX, centerY);
            });
        }

        // Hoşgeldin ekranı
        function initWelcomeScreen() {
            const startGame = () => {
                // Kaydedilmiş oyun durumunu yükle
                const hasSavedGame = loadGameState();
                
                gsap.to(welcomeScreen, {
                    opacity: 0,
                    duration: 0.5,
                    onComplete: () => {
                        welcomeScreen.style.display = 'none';
                        shopElement.classList.add('hidden');
                        gameStarted = true;
                        
                        if (hasSavedGame) {
                            showMessage('Kaydedilmiş oyun yüklendi! Kaldığınız yerden devam edin.', '#00FF00');
                        } else {
                            showMessage('Oyun başladı! Gezegenlere tıkla! (Mağaza: M tuşu)', '#00FF00');
                        }
                    }
                });
            };

            document.querySelector('.start-btn').addEventListener('click', startGame);
            document.querySelector('.start-btn').addEventListener('touchend', startGame);
        }

        // Mağaza aç/kapa
        function toggleShop() {
            if (!gameStarted) {
                showMessage('Önce oyunu başlatmalısın!', '#FF0000');
                return;
            }
            shopElement.classList.toggle('hidden');
        }

        // Animasyon döngüsü
        function animate() {
            requestAnimationFrame(animate);
            
            // Gezegenleri yavaşça döndür
            planets.forEach(planet => {
                planet.rotation.y += 0.005;
            });
            
            renderer.render(scene, camera);
        }

        // Pencere boyutu değişikliği
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Oyun başlatma
        window.addEventListener('resize', onWindowResize);
        createStars();
        initWelcomeScreen();
        initPlanets();
        initClickEvents();
        initKeyboardControls();
        animate();
        startAutoClickers();

        // Mağaza butonları
        openShopBtn.addEventListener('click', toggleShop);
        closeShopBtn.addEventListener('click', toggleShop);
        mobileShopBtn.addEventListener('click', toggleShop);

        // Mobil için touch eventleri
        openShopBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            toggleShop();
        });
        closeShopBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            toggleShop();
        });

        // Sayfa kapanırken oyunu kaydet
        window.addEventListener('beforeunload', () => {
            saveGameState();
        });
    </script>
</body>
</html>